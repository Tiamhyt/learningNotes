# 关于版本控制

##### 文件的版本

* 操作麻烦: 每次都需要复制>粘贴>重命名
* 命名不规范:无法通过文件名知道具体做了那些修改.
* 容易丢失:如果硬盘故障或者不小心删除,文件很容易丢失.
* 写作困难:需要手动合并每个人对项目的修改,合并时极容易出错.

##### 版本控制软件

**概念:**

版本控制软件是一个用来==记录文件变化==以便将来查询特定版本修改情况的系统,因此有时也叫做“**版本控制系统**”

**通俗的理解:**

把==手工管理==文件版本的方式,改为由==软件管理==文件的版本,这个负责管理文件的软件,叫做“==版本控制软件==”

---

##### 使用版本控制软件的好处

1. 操作简便
   * 只需要==记住几组简单的终端命令==即可快速上手常见的版本控制软件
2. 易于对比:
   * 基于版本控制软件提供的功能,能够方便地比较文件的变化细节,从而查找出导致问题的原因
3. 易于回溯:
   * 可以将选定的文件回溯到之前的状态,甚至将整个项目都回退到过去某个时间点的状态
4. 不易丢失:
   * 在版本控制软件中,被用户误删除的文件,可以轻松的恢复回来
5. 协作方便:
   * 基于版本控制软件提供的==分支==功能,可以轻松实现多人协作开发时的代码合并操作

---

 ##### 版本控制系统的分类

* 本地版本控制系统
  * ==单击运行==,使维护文件版本的操作工具化
* 集中化版本控制系统
  * 联网运行,支持多人协作开发;==性能差、用户体验不好==
* 分布式版本控制系统
  * ==联网运行，支持多人协作开发；性能优秀、用户体验好==

---

# Git基础概念

#### 1. 什么是Git

* Git是一个==开源分布式版本控制系统==,是目前世界上==最先进,最流行==的版本控制系统,可以快速高效的处理从很小到非常大的项目版本控制管理
* 特点:
  * 项目越大越复杂,协同开发者越多,越能体现出Git的==高性能==和==高可用性==

---

#### 2.Git的特性

Git之所以快速和高效,主要依赖于它的如下俩个特性:

1. 直接记录快照,而非差异比较
2. 近乎所有操作都是本地执行

##### 2.1 SVN的差异比较

传统的版本控制系统(例如SVN)是==基于差异==的版本控制,他们存储的是==一组基本文件==和==每个文件随事件逐步累计的差异==

**好处:**节省磁盘空间

**缺点:**==耗时,效率低==

* * 在每次切换版本的时候,都需要在基本文件的基础上,应用每个差异,从而生成目标版本对应的文件.

##### 2.2 Git的记录快照

Git快照是在原有文件版本的基础上重新生成一份新的文件,==类似于备份==.为了效率,如果文件没有被修改,Git不在重新存储该文件,而是只保留一个链接指向之前存储的文件.

**缺点:**占用磁盘空间较大

**优点:**==版本切换时非常快==,因为每个版本都是完整文件快照,切换版本时直接恢复目标版本的快照即可.

**特点:**==空间换时间==

##### 2.3近乎所有操作都是本地执行

在Git中的绝大多数操作都==只需要访问本地文件和资源,一般不需要来自网络上其他计算机的信息.

**特性:**

1. 断网后依旧可以在本地对项目进行版本管理
2. 联网后,把本地修改的记录同步到云端服务器即可

---

#### 3. Git中的三个区域

使用Git管理的项目,拥有三个区域,分别是==工作区,暂存区,Git仓库==

* 工作区
  * 处理工作的区域
* 暂存区
  * 已经完成的工作的==临时存放区域==,==等待被提交==
* Git仓库
  * 最终存放的区域

---

#### 4. Git中的三中状态

* 已修改(modified):表示修改了文件,但还没将修改的结果放到暂存区
* 已暂存(staged):表示对已修改文件的当前版本做了标记,使之包含在下次提交的列表中.
* 已提交(committed):表示文件已经安全的保存到本地的Git仓库中.

> 注意:
>
> * 工作区的文件被修改了,但是还没放到暂存区,就是**已修改**状态
> * 如果文件已修改并放入暂存区,就属于**已暂存**状态
> * 如果Git仓库中==保存着特定版本==的文件,就属于**已提交**状态

---

#### 5. 基本的Git工作流程

基本的Git工作流程如下:

1. 在工作区中修改文件
2. 将你想要下次提交的更改进行暂存
3. 提交更新,找到暂存区的文件,将快照永久性存储到Git仓库

---

# Git基础

#### 配置用户信息

` git config --global user.name "xushu"`:配置用户名

`git config --global user.email "2074720793@qq.com"`:配置邮箱

#### Git的全局配置文件

通过`git config --global user.name`和`git config --global user.email`配置的用户名和邮箱地址,会被写入到`C:/Users/用户名文件夹/.gitconfig`文件中.这个文件是Git的==全局配置文件,配置一次即可永久生效==

---

#### 检查配置信息

除了使用记事本查看全局的配置信息外,还可以运行如下终端命令,快速查看Git的全局配置信息:

```js
//# 查看所有的全局配置项
git config --list --global
//# 查看指定的全局配置项
git config user.name
git config user.email
```

---

#### 获取帮助信息

可以使用`git help <verb>`命令,无需联网即可在浏览器中打开帮助手册,例如:

```js
//# 要想打开git config 命令帮助手册
git help config
```

如果不想查看完整的手册,那么可以使用`-h`选项获得更简明的“`help`”输出:

```js
// # 想要获取git config 命令的快速参考
git config -h
```

---

### Git的基本操作

#### 1.获取Git仓库的两种方式

1. ==将==尚未进行版本控制的==本地目录转换为Git仓库==
2. 从其他服务器==克隆==一个已存在的Git仓库

以上俩种方式都可以在自己的电脑上得到一个可用的Git仓库

#### 2.在现有的目录中初始化仓库

1. 在项目目录中,通过鼠标右键打开`Git bash`
2. 执行`git init`命令将当前的目录转化为Git仓库

> `git init`命令会创建一个名为.git的隐藏目录,==这个.git目录就是当前项目的Git仓库==,里面包含了==初始的必要文件==,这些文件是Git仓库的==必要组成部分==

---

#### 3.工作区中文件的4种状态

工作区中的每一个文件可能有==4种状态==,这四种状态共分为==俩大类==

* ==未被Git管理==
  * **未跟踪(Untracked)**:不被Git所管理的文件
* ==已被Git管理==
  * **未修改(Unmodified)**:工作区中文件的内容和Git仓库中文件的内容==保持一致==
  * **已修改(Modified)**:工作区文件的内容和Git仓库中文件的内容==不一致==
  * **已暂存(Staged)**:工作区中被修改的文件已被放到暂存区,准备将修改后的文件保存到Git仓库中

> Git操作的终极结果:让工作区中的文件都处于==未修改==状态

#### 4.检查文件的状态

可以使用`git status`命令查看文件处于什么状态

![image-20221222120042205](D:\网页制作\学习笔记\assets\image-20221222120042205.png)

在状态报告中可以看到文件出现在`Untracked files:`(未跟踪文件)下面

未跟踪的文件意味着==Git在之前的快照(提交)==中没有这些文件;Git不会自动将之纳入跟踪范围,除非明确地告诉它“我需要使用Git跟踪管理改文件”

#### 5.以精简的方式显示文件状态

使用`git status`输出的状态报告很详细,但有些繁琐,如果希望==以精简的方式显示文件的状态==,可以使用如下俩条完全等价的命令,其中`-s`是`--short`的简写形式

```js
//# 以精简的方式显示文件状态
git status -s
git status --short
```

未跟踪文件前面有==红色==的==??==标记,例如:

![image-20221222124513865](D:\网页制作\学习笔记\assets\image-20221222124513865.png)

---

#### 6.跟踪新文件

使用命令`git add`开始跟踪文件.所以,要跟踪文件,运行如下命令即可:

```js
git add 文件名
```

此时在运行`git status`命令,会看到你所添加的文件在`Changes to be committed`这行下面,说明==已被跟踪==,并==处于暂存状态==:

![image-20221222124530883](D:\网页制作\学习笔记\assets\image-20221222124530883.png)

##### 以精简方式显示

==新添加到暂存区==中的文件前面有==绿色==的A标记

![image-20221222124541168](D:\网页制作\学习笔记\assets\image-20221222124541168.png)

---

#### 7.提交更新

现在暂存区中有一个你刚刚所添加的文件,==等待被提交==到Git仓库中进行保存.可以执行`git commit`命令进行提交,其中`-m`选项后面是本次提交的==提示信息==,用来==对提示的内容做进一步的描述:==

```js
git commit - m "备注信息"
```

提交成功之后,会显示如下信息:

![image-20221222124552790](D:\网页制作\学习笔记\assets\image-20221222124552790.png)

提交成功之后,在此检查文件的状态,得到提示如下:

![image-20221222124610959](D:\网页制作\学习笔记\assets\image-20221222124610959.png)

---

#### 8.对已提交的文件进行修改

当我们修改了工作区中==已被Git跟踪==的内容之后,再次运行`git status`和`git status -s `命令,会看到如下内容:

```shell

$ git status
On branch master
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
        modified:   index.html

no changes added to commit (use "git add" and/or "git commit -a"
```

文件出现在`Changes not staged for commit:`这行下面,说明==已跟踪文件的内容发生了变化,但还没有放到暂存区==

![image-20221222140724939](D:\网页制作\学习笔记\assets\image-20221222140724939.png)

> 注意:修改过的,没有放到暂存区的文件 前面有==红色==的==M==标记
>
> ![image-20221222140746748](D:\网页制作\学习笔记\assets\image-20221222140746748.png)

---

#### 9.暂存已修改的文件

如果要暂存这次修改,需要在此运行`git add`命令,这个命令是个多功能的命令主要有如下三个功能:

1. 可以用它==开始跟踪新文件==
2. 把==已跟踪的,且已修改的==文件放到暂存区
3. 把有冲突的文件标记为已解决状态

![image-20221222161625388](D:\网页制作\学习笔记\assets\image-20221222161625388.png)

#### 10.提交已暂存的文件

再次运行`git commit -m “消息提示”`命令,即可将暂存区中记录的==已修改的文件==进行快照,提交到Git仓库中进行保存

![image-20221222171142991](D:\网页制作\学习笔记\assets\image-20221222171142991.png)

---

#### 11.撤销对文件的修改

使用`git checkout -- 文件名`

撤销对文件的修改指的是:把对工作区中对应文件的修改,==还原==成Git仓库中所保存的版本.

操作的结果是:所有的修改都会消失.且无法恢复! ==危险性比较高,慎重操作==

![image-20221222171118809](D:\网页制作\学习笔记\assets\image-20221222171118809.png)

> 撤销操作的本质:用Git仓库中保存的文件,覆盖工作区中指定的文件

---

#### 12.向暂存区中一次性添加多个文件

语法:`git add .`

![image-20221222171056528](D:\网页制作\学习笔记\assets\image-20221222171056528.png)

---

#### 13.取消暂存的文件

如果需要从暂存区中移除对应的文件 可以使用`git reset HEAD 要移除的文件名称`

![image-20221222171012646](D:\网页制作\学习笔记\assets\image-20221222171012646.png)

如果需要于移除多个文件,可以使用`git reset HEAD .`

![image-20221222170839405](D:\网页制作\学习笔记\assets\image-20221222170839405.png)

---

#### 14.跳过使用暂存区域

Git标准的工作流程是==工作区==->==暂存区==->==Git仓库==,但有时候这么做略显繁琐,此时可以跳过暂存区,直接将工作区的修改提交到Git仓库,这时候Git的工作流程简化为了==工作区==->==Git仓库== 

Git提供了一个跳过暂存区域的方式,==只要在提交的时候==给`git commit`加上`-a`选项,Git就会自动把所有==已经跟踪过的文件==暂存起来一并提交,从而跳过git add步骤:

语法:`git commit -a -m "提示信息"`

![image-20221222170639111](D:\网页制作\学习笔记\assets\image-20221222170639111.png)

---

#### 15.移除文件

从Git仓库中移除文件的方式有俩种

1. 从Git仓库和工作区中==同时移除==对应的文件
   1. 语法:`git rm -f 文件名`

![image-20221222171509527](D:\网页制作\学习笔记\assets\image-20221222171509527.png)

1. 只从Git仓库中移除指定的文件,但保留工作区中对应的文件
   1. 语法:`git rm --cached 文件名`

![image-20221222171707583](D:\网页制作\学习笔记\assets\image-20221222171707583.png)

---

#### 16.忽略文件

创建一个名为`.gitignore`的配置文件,列出要忽略的文件的匹配模式

文件.gitignore 的格式规范如下:

1. 以==#开头==的是注释
2. 以==/结尾==的是目录
3. 以==/开头==防止递归
4. 以==!开头==表示取反
5. 可以使用==glob模式==进行文件和文件夹的匹配(glob指简化了的正则表达式)

---

#### 17.glob模式

所谓的==glob模式==是指简化了的正则表达式:

1. ==*==匹配==零个或多个任意字符==
2. ==[abc]==匹配==任何一个列在方括号中的字符== (此案例表示匹配一个a或匹配一个b或匹配一个c)
3. ==问号?==只==匹配一个任意字符==
4. 在方括号中使用==短划线==分隔俩个字符串,表示所有在这俩个字符范围内的都可以匹配(比如[0-9]表示匹配所有0到9的数字)
5. ==两个星号**==表示==匹配任意中间目录==(比如a/**/z 可以匹配 a/z,a/v/z 或a/b/c/z)

```js
# 忽略所有的.a文件
*.a

# 但跟踪所有的lib.a,即使你在前面忽略了.a文件
!lib.a

# 只忽略当前目录下的TOOP文件,而不忽略subdir/TOOP
/TOOP

# 忽略任何目录下名为build的文件夹
build/
    
# 忽略doc/notes.txt ,但不忽略 doc/server/arch.txt
doc/*.txt

# 忽略doc/目录及其所有子目录下的.pdf文件
doc/**/*.pdf
```

---

#### 18.查看提交历史

1. 使用`git log`:按时间先后顺序列出所有的提交历史,最近的提交排在最上面

   ![image-20221222190701858](D:\网页制作\学习笔记\assets\image-20221222190701858.png)

2. 使用`git log -2`:只展示最新的两条提交历史 数字可以按需填写

   ![image-20221222190727937](D:\网页制作\学习笔记\assets\image-20221222190727937.png)

3. 使用`git log -2 --pretty=oneline`:在一行上展示最近俩条提交历史的信息

   ​	![image-20221222190800669](D:\网页制作\学习笔记\assets\image-20221222190800669.png)

4. 使用`git log -2 --pretty=format:"%h |%an |%ar |%s"`:在一行上展示最近俩条提交历史的信息,并自定义输出格式,其中

   ==%h==:提交的简写哈希值(地址)

   ==%an==:作者的名字

   ==%ar==:作者修订日期,按多久以前的方式显示

   ==%s==:提交说明

   ![image-20221222190846694](D:\网页制作\学习笔记\assets\image-20221222190846694.png)

---

#### 19.回退到指定版本

1. 需要先查看项目的所有提交历史使用`git log --pretty=oneline`
2. 使用`git reset --hard 地址`,根据指定的提交 ID 回退到指定版本![image-20221222194258541](D:\网页制作\学习笔记\assets\image-20221222194258541.png)

如果回退了旧版本想要重新回退到最新版本

1. 使用`git reflog --pretty=oneline`
2. 在根据最新的提交ID跳转到最新的版本`git reset --hard <ommitID>`

![image-20221222194324449](D:\网页制作\学习笔记\assets\image-20221222194324449.png)
